var IMAGE_HEIGHT=64;var IMAGE_TOP_MARGIN=5;var IMAGE_BOTTOM_MARGIN=5;var SLOT_SEPARATOR_HEIGHT=2;var SLOT_HEIGHT=IMAGE_HEIGHT+IMAGE_TOP_MARGIN+IMAGE_BOTTOM_MARGIN+SLOT_SEPARATOR_HEIGHT;var RUNTIME=3000;var SPINTIME=1000;var ITEM_COUNT=6;var SLOT_SPEED=15;var DRAW_OFFSET=45;function preloadImages(b,e){function a(f){f.img=new Image();f.img.src="http://images.shopclues.com/images/banners/fb_contest/"+f.id+".png";f.img.addEventListener("load",function(){d()},false);f.img.addEventListener("error",function(g){d(g,f.id)},false)}var c=0;function d(f,g){if(f){alert("Failed to load "+g)}c++;if(b.length==c){return e()}}b.forEach(function(f){a(f)})}function copyArray(c){var b=[];for(var a=0;a<c.length;a++){b.push(c[a])}return b}function slot_play_game(){var b=new Game();var a=[{id:"home_Appliances"},{id:"electronics"},{id:"apperal"},{id:"pendrives"},{id:"mobile"},{id:"TRy-again"}];$("canvas").attr("height",IMAGE_HEIGHT*ITEM_COUNT*2);$("canvas").css("height",IMAGE_HEIGHT*ITEM_COUNT*2);b.items=a;preloadImages(a,function(){function c(e,d){ctx=e.getContext("2d");ctx.fillStyle="#ddd";for(var f=0;f<ITEM_COUNT;f++){var g=d[f];ctx.save();ctx.shadowColor="rgba(0,0,0,0.5)";ctx.shadowOffsetX=5;ctx.shadowOffsetY=5;ctx.shadowBlur=5;ctx.drawImage(g.img,3,f*SLOT_HEIGHT+IMAGE_TOP_MARGIN);ctx.drawImage(g.img,3,(f+ITEM_COUNT)*SLOT_HEIGHT+IMAGE_TOP_MARGIN);ctx.restore();ctx.fillRect(0,f*SLOT_HEIGHT,70,SLOT_SEPARATOR_HEIGHT);ctx.fillRect(0,(f+ITEM_COUNT)*SLOT_HEIGHT,70,SLOT_SEPARATOR_HEIGHT)}}b.items1=copyArray(a);c(b.c1[0],b.items1);b.items2=copyArray(a);c(b.c2[0],b.items2);b.items3=copyArray(a);c(b.c3[0],b.items3);b.resetOffset=(ITEM_COUNT+3)*SLOT_HEIGHT;b.loop()});$("#play").click(function(c){$("#play").remove();$("#play1").remove();$("#play2").show();b.restart()})}function Game(){this.c1=$("#canvas1");this.c2=$("#canvas2");this.c3=$("#canvas3");this.offset1=-parseInt(Math.random()*ITEM_COUNT)*SLOT_HEIGHT;this.offset2=-parseInt(Math.random()*ITEM_COUNT)*SLOT_HEIGHT;this.offset3=-parseInt(Math.random()*ITEM_COUNT)*SLOT_HEIGHT;this.speed1=this.speed2=this.speed3=0;this.lastUpdate=new Date();this.vendor=(/webkit/i).test(navigator.appVersion)?"-webkit":(/firefox/i).test(navigator.userAgent)?"-moz":(/msie/i).test(navigator.userAgent)?"ms":"opera" in window?"-o":"";this.cssTransform=this.vendor+"-transform";this.has3d=("WebKitCSSMatrix" in window&&"m11" in new WebKitCSSMatrix());this.trnOpen="translate"+(this.has3d?"3d(":"(");this.trnClose=this.has3d?",0)":")";this.scaleOpen="scale"+(this.has3d?"3d(":"(");this.scaleClose=this.has3d?",0)":")";this.draw(true)}Game.prototype.restart=function(){this.lastUpdate=new Date();this.speed1=this.speed2=this.speed3=SLOT_SPEED;function a(b,d){for(var c=0;c<b.length;c++){if(b[c].id==d){return c}}}this.result1=$("#hid1").val();this.result2=$("#hid2").val();this.result3=$("#hid3").val();this.stopped1=false;this.stopped2=false;this.stopped3=false;this.offset1=-parseInt(Math.random(ITEM_COUNT))*SLOT_HEIGHT;this.offset2=-parseInt(Math.random(ITEM_COUNT))*SLOT_HEIGHT;this.offset3=-parseInt(Math.random(ITEM_COUNT))*SLOT_HEIGHT;$("#results").hide();this.state=1};window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b,a){window.setTimeout(b,1000/60)}})();Game.prototype.loop=function(){var a=this;a.running=true;(function b(){a.update();a.draw();if(a.running){requestAnimFrame(b)}})()};Game.prototype.update=function(){var b=new Date();var c=this;function d(f,e){if(b-c.lastUpdate>SPINTIME){var g=parseInt(Math.abs(f/SLOT_HEIGHT))%ITEM_COUNT;if(g==e){if(e==0){if(Math.abs(f+(ITEM_COUNT*SLOT_HEIGHT))<(SLOT_SPEED*1.5)){return true}}else{if(Math.abs(f+(e*SLOT_HEIGHT))<(SLOT_SPEED*1.5)){return true}}}}return false}switch(this.state){case 1:if(b-this.lastUpdate>RUNTIME){this.state=2;this.lastUpdate=b}break;case 2:this.stopped1=d(this.offset1,this.result1);if(this.stopped1){this.speed1=0;this.state++;this.lastUpdate=b}break;case 3:this.stopped2=d(this.offset2,this.result2);if(this.stopped2){this.speed2=0;this.state++;this.lastUpdate=b}break;case 4:this.stopped3=d(this.offset3,this.result3);if(this.stopped3){this.speed3=0;this.state++}break;case 5:if(b-this.lastUpdate>3000){this.state=6}break;case 6:$("#results").show();if(this.result1==this.result2&&this.result2==this.result3){var a="win_form.php";setTimeout(function(){window.location.href=a},3000)}else{location.reload(true)}this.state=7;break;case 7:break;default:}this.lastupdate=b};Game.prototype.draw=function(e){if(this.state>=6){return}for(var a=1;a<=3;a++){var d="result"+a;var g="stopped"+a;var b="speed"+a;var h="offset"+a;var f="c"+a;if(this[g]||this[b]||e){if(this[g]){this[b]=0;var j=this[d];this[h]=-(j*SLOT_HEIGHT);if(this[h]+DRAW_OFFSET>0){this[h]=-this.resetOffset+SLOT_HEIGHT*3}}else{this[h]+=this[b];if(this[h]+DRAW_OFFSET>0){this[h]=-this.resetOffset+SLOT_HEIGHT*3-DRAW_OFFSET}}this[f].css(this.cssTransform,this.trnOpen+"0px, "+(this[h]+DRAW_OFFSET)+"px"+this.trnClose)}}};